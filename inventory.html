<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M.J. Gross Inc. | Inventory</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22 style=%22background-color:black;%22><text x=%2250%25%22 y=%2255%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22serif%22 font-weight=%22bold%22 font-size=%2250%22 fill=%22white%22>MJG</text></svg>">
    
    <style>
        :root {
            --primary: #000000;
            --accent: #C5A059;
            --bg-gray: #f4f6f8;
            --border: #e2e8f0;
            --text-muted: #64748b;
        }
        
        * { box-sizing: border-box; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; background-color: var(--bg-gray); color: #333; }

        /* HEADER */
        header { background: #fff; padding: 12px 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        .logo-img { height: 35px; }
        .back-link { font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 700; text-transform: uppercase; }

        /* LAYOUT */
        .inventory-container { display: flex; min-height: calc(100vh - 60px); }

        /* SIDEBAR FILTERS */
        .sidebar {
            width: 350px;
            background: #fff;
            border-right: 1px solid #ddd;
            padding: 20px;
            flex-shrink: 0;
            overflow-y: auto;
            height: calc(100vh - 60px);
            position: sticky;
            top: 60px;
        }

        .filter-group { margin-bottom: 25px; border-bottom: 1px solid #f1f5f9; padding-bottom: 20px; }
        .filter-group:last-child { border-bottom: none; }
        .filter-label { font-weight: 800; display: block; margin-bottom: 12px; font-size: 0.75rem; letter-spacing: 1px; color: var(--text-muted); text-transform: uppercase; }
        
        /* SHAPE GRID */
        .shape-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        
        /* BUTTON STYLES */
        .btn-toggle {
            background: #fff; border: 1px solid #cbd5e1; padding: 10px 4px; 
            font-size: 0.75rem; cursor: pointer; border-radius: 4px; 
            transition: 0.1s; font-weight: 600; color: #475569; text-align: center;
        }
        .btn-toggle.active { background-color: var(--primary); color: #fff; border-color: var(--primary); }

        /* CARAT GRID */
        .carat-row { display: grid; gap: 6px; margin-bottom: 6px; }
        .row-3 { grid-template-columns: repeat(3, 1fr); }
        .row-4 { grid-template-columns: repeat(4, 1fr); }

        /* TOUCH BARS (Color/Clarity/Cut) */
        .touch-bar { display: flex; width: 100%; margin-bottom: 10px; }
        .touch-btn {
            flex-grow: 1; padding: 10px 0; background: #fff; border: 1px solid #cbd5e1;
            margin-left: -1px; cursor: pointer; font-size: 0.75rem; font-weight: 600; color: #475569; text-align: center;
        }
        .touch-btn:first-child { border-top-left-radius: 4px; border-bottom-left-radius: 4px; margin-left: 0; }
        .touch-btn:last-child { border-top-right-radius: 4px; border-bottom-right-radius: 4px; }
        .touch-btn.active { background-color: var(--primary); color: #fff; border-color: var(--primary); z-index: 1; position: relative; }

        /* NUMERIC INPUTS (Depth, Table, Meas) */
        .range-row { display: flex; gap: 10px; align-items: center; margin-bottom: 8px; }
        .range-label { width: 60px; font-size: 0.8rem; font-weight: 600; color: #444; }
        .range-input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.85rem; }

        /* RESULTS AREA */
        .results-area { flex-grow: 1; padding: 20px; overflow-x: hidden; }
        .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        
        /* TABLE */
        .table-wrapper { overflow-x: auto; border-radius: 6px; border: 1px solid #e2e8f0; }
        table { width: 100%; border-collapse: collapse; background: #fff; min-width: 1000px; }
        th { background: #f8fafc; color: #475569; padding: 10px; text-align: left; font-size: 0.7rem; text-transform: uppercase; font-weight: 700; border-bottom: 2px solid #e2e8f0; white-space: nowrap; }
        td { padding: 10px; border-bottom: 1px solid #eee; font-size: 0.8rem; color: #334155; white-space: nowrap; }
        tr:hover { background-color: #f1f5f9; cursor: pointer; }

        /* MOBILE */
        .mobile-filter-bar { display: none; padding: 10px; background: #fff; border-bottom: 1px solid #ddd; position: sticky; top: 60px; z-index: 900; }
        .filter-toggle-btn { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; font-weight: bold; border-radius: 4px; }

        @media (max-width: 900px) {
            .inventory-container { flex-direction: column; }
            .sidebar { 
                width: 100%; height: auto; display: none; 
                position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 2000;
                padding: 20px; overflow-y: scroll;
            }
            .sidebar.show { display: block; }
            .mobile-filter-bar { display: block; }
            
            /* Add close button for mobile sidebar */
            .mobile-close { display: block; text-align: right; margin-bottom: 10px; font-size: 1.5rem; cursor: pointer; }
        }
        @media (min-width: 901px) { .mobile-close { display: none; } }
    </style>
</head>
<body>

    <header>
        <a href="index.html"><img src="images/logo.jpg" alt="MJG" class="logo-img"></a>
        <a href="index.html" class="back-link">Log Out</a>
    </header>

    <div class="mobile-filter-bar">
        <button class="filter-toggle-btn" onclick="toggleSidebar()">Filters <span id="mobile-count">(0)</span> ▾</button>
    </div>

    <div class="inventory-container">
        
        <aside class="sidebar" id="sidebar">
            <div class="mobile-close" onclick="toggleSidebar()">✕</div>

            <div class="filter-group">
                <span class="filter-label">SHAPE</span>
                <div class="shape-grid">
                    <button class="btn-toggle" onclick="toggleShape(this, 'Round')">Round</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Oval')">Oval</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Cushion')">Cushion</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Emerald')">Emerald</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Pear')">Pear</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Radiant')">Radiant</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Princess')">Princess</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Asscher')">Asscher</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Marquise')">Marquise</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Heart')">Heart</button>
                    <button class="btn-toggle" onclick="toggleShape(this, 'Other')">Other</button>
                </div>
            </div>

            <div class="filter-group">
                <span class="filter-label">SIZE (CARAT)</span>
                <div class="carat-row row-3">
                    <button class="btn-toggle" onclick="toggleCarat(0.30, 0.99, this)">0.30-0.99</button>
                    <button class="btn-toggle" onclick="toggleCarat(1.00, 1.49, this)">1.00-1.49</button>
                    <button class="btn-toggle" onclick="toggleCarat(1.50, 1.99, this)">1.50-1.99</button>
                </div>
                <div class="carat-row row-4">
                    <button class="btn-toggle" onclick="toggleCarat(2.00, 2.99, this)">2.00-2.99</button>
                    <button class="btn-toggle" onclick="toggleCarat(3.00, 3.99, this)">3.00-3.99</button>
                    <button class="btn-toggle" onclick="toggleCarat(4.00, 4.99, this)">4.00-4.99</button>
                    <button class="btn-toggle" onclick="toggleCarat(5.00, 99.9, this)">5.00+</button>
                </div>
                <div class="range-row">
                    <input type="number" id="min-carat" class="range-input" placeholder="Min Carat" step="0.01" oninput="runSearch()">
                    <input type="number" id="max-carat" class="range-input" placeholder="Max Carat" step="0.01" oninput="runSearch()">
                </div>
            </div>

            <div class="filter-group">
                <span class="filter-label">COLOR</span>
                <div class="touch-bar" id="color-bar"></div>
            </div>

            <div class="filter-group">
                <span class="filter-label">CLARITY</span>
                <div class="touch-bar" id="clarity-bar"></div>
            </div>

            <div class="filter-group">
                <span class="filter-label">CUT</span>
                <div class="touch-bar" id="cut-bar"></div>
                
                <span class="filter-label">POLISH</span>
                <div class="touch-bar" id="polish-bar"></div>
                
                <span class="filter-label">SYMMETRY</span>
                <div class="touch-bar" id="sym-bar"></div>
            </div>

            <div class="filter-group">
                <span class="filter-label">DEPTH %</span>
                <div class="range-row">
                    <input type="number" id="depth-min" class="range-input" placeholder="From" oninput="runSearch()">
                    <input type="number" id="depth-max" class="range-input" placeholder="To" oninput="runSearch()">
                </div>
                
                <span class="filter-label" style="margin-top:10px;">TABLE %</span>
                <div class="range-row">
                    <input type="number" id="table-min" class="range-input" placeholder="From" oninput="runSearch()">
                    <input type="number" id="table-max" class="range-input" placeholder="To" oninput="runSearch()">
                </div>
            </div>

            <div class="filter-group">
                <span class="filter-label">MEASUREMENTS (MM)</span>
                <div class="range-row">
                    <span class="range-label">L (1)</span>
                    <input type="number" id="m1-min" class="range-input" placeholder="Min" oninput="runSearch()">
                    <input type="number" id="m1-max" class="range-input" placeholder="Max" oninput="runSearch()">
                </div>
                <div class="range-row">
                    <span class="range-label">W (2)</span>
                    <input type="number" id="m2-min" class="range-input" placeholder="Min" oninput="runSearch()">
                    <input type="number" id="m2-max" class="range-input" placeholder="Max" oninput="runSearch()">
                </div>
                <div class="range-row">
                    <span class="range-label">D (3)</span>
                    <input type="number" id="m3-min" class="range-input" placeholder="Min" oninput="runSearch()">
                    <input type="number" id="m3-max" class="range-input" placeholder="Max" oninput="runSearch()">
                </div>
            </div>

            <div class="filter-group">
                <span class="filter-label">RATIO</span>
                <div class="range-row">
                    <input type="number" id="ratio-min" class="range-input" placeholder="Min Ratio" step="0.01" oninput="runSearch()">
                    <input type="number" id="ratio-max" class="range-input" placeholder="Max Ratio" step="0.01" oninput="runSearch()">
                </div>
            </div>

            <button onclick="toggleSidebar()" class="filter-toggle-btn" style="margin-top: 20px; background: #333;">VIEW RESULTS</button>
        </aside>

        <main class="results-area">
            <div class="results-header">
                <h2>Inventory</h2>
                <span class="result-count">Found <span id="count">0</span> Stones</span>
            </div>
            
            <div class="table-wrapper">
                <table id="inventory-table">
                    <thead>
                        <tr>
                            <th>Shape</th>
                            <th>Carat</th>
                            <th>Color</th>
                            <th>Clarity</th>
                            <th>Cut</th>
                            <th>Pol</th>
                            <th>Sym</th>
                            <th>Flor</th>
                            <th>Depth</th>
                            <th>Table</th>
                            <th>Ratio</th>
                            <th>Meas (mm)</th>
                            <th>Price</th> 
                        </tr>
                    </thead>
                    <tbody id="table-body"></tbody>
                </table>
            </div>
        </main>
    </div>

    <script>
        // --- DATA & CONFIG ---
        const colors = ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M'];
        const clarities = ['FL', 'IF', 'VVS1', 'VVS2', 'VS1', 'VS2', 'SI1', 'SI2', 'I1'];
        const grades = ['EX', 'VG', 'GD', 'FR']; // For Cut, Pol, Sym
        
        // Mock Data with Extended Specs
        const inventoryData = [
            { shape: "Round", carat: 1.01, color: "D", clarity: "VS1", cut: "EX", pol: "EX", sym: "EX", fluor: "Non", depth: 61.5, table: 57, ratio: 1.00, m1: 6.45, m2: 6.48, m3: 3.98, price: 5000 },
            { shape: "Oval", carat: 1.50, color: "F", clarity: "SI1", cut: "VG", pol: "EX", sym: "VG", fluor: "Fnt", depth: 62.0, table: 59, ratio: 1.45, m1: 9.10, m2: 6.30, m3: 3.90, price: 6500 },
            { shape: "Emerald", carat: 2.10, color: "H", clarity: "VVS2", cut: "EX", pol: "VG", sym: "EX", fluor: "Non", depth: 66.0, table: 61, ratio: 1.35, m1: 8.50, m2: 6.30, m3: 4.15, price: 12000 },
            { shape: "Pear", carat: 3.05, color: "I", clarity: "VS1", cut: "EX", pol: "EX", sym: "EX", fluor: "Med", depth: 60.5, table: 58, ratio: 1.60, m1: 12.2, m2: 7.60, m3: 4.60, price: 25000 },
            { shape: "Cushion", carat: 5.01, color: "G", clarity: "FL", cut: "EX", pol: "EX", sym: "EX", fluor: "Non", depth: 68.0, table: 62, ratio: 1.10, m1: 9.80, m2: 8.90, m3: 6.05, price: 80000 },
            { shape: "Radiant", carat: 4.50, color: "J", clarity: "SI2", cut: "VG", pol: "VG", sym: "VG", fluor: "Stg", depth: 70.0, table: 65, ratio: 1.25, m1: 10.0, m2: 8.00, m3: 5.60, price: 22000 },
        ];

        // --- STATE ---
        let activeShapes = [];
        let activeCaratRanges = [];
        let activeColors = [];
        let activeClarities = [];
        let activeCuts = [];
        let activePols = [];
        let activeSyms = [];

        // --- UI BUILDERS ---
        function initTouchBar(id, items, activeArray, clickHandler) {
            const container = document.getElementById(id);
            container.innerHTML = '';
            items.forEach((item, index) => {
                const btn = document.createElement('div');
                btn.className = 'touch-btn';
                btn.innerText = item;
                btn.onclick = () => window[clickHandler](index);
                container.appendChild(btn);
            });
        }

        initTouchBar('color-bar', colors, activeColors, 'handleColorClick');
        initTouchBar('clarity-bar', clarities, activeClarities, 'handleClarityClick');
        initTouchBar('cut-bar', grades, activeCuts, 'handleCutClick');
        initTouchBar('polish-bar', grades, activePols, 'handlePolClick');
        initTouchBar('sym-bar', grades, activeSyms, 'handleSymClick');

        // --- FILTER LOGIC ---
        function handleRangeClick(index, activeArray, domId) {
            // Smart range logic: connect D to F selects E
            if (activeArray.length === 0) activeArray.push(index);
            else {
                const min = Math.min(Math.min(...activeArray), index);
                const max = Math.max(Math.max(...activeArray), index);
                activeArray.length = 0;
                for (let i = min; i <= max; i++) activeArray.push(i);
            }
            updateTouchUI(domId, activeArray);
            runSearch();
        }

        function updateTouchUI(domId, activeArray) {
            const btns = document.getElementById(domId).children;
            for (let i = 0; i < btns.length; i++) {
                btns[i].classList.toggle('active', activeArray.includes(i));
            }
        }

        // Handlers
        window.handleColorClick = (i) => handleRangeClick(i, activeColors, 'color-bar');
        window.handleClarityClick = (i) => handleRangeClick(i, activeClarities, 'clarity-bar');
        window.handleCutClick = (i) => handleRangeClick(i, activeCuts, 'cut-bar');
        window.handlePolClick = (i) => handleRangeClick(i, activePols, 'polish-bar');
        window.handleSymClick = (i) => handleRangeClick(i, activeSyms, 'sym-bar');

        window.toggleShape = (btn, shape) => {
            btn.classList.toggle('active');
            activeShapes.includes(shape) ? activeShapes = activeShapes.filter(s => s !== shape) : activeShapes.push(shape);
            runSearch();
        };

        window.toggleCarat = (min, max, btn) => {
            btn.classList.toggle('active');
            const idx = activeCaratRanges.findIndex(r => r.min === min && r.max === max);
            idx >= 0 ? activeCaratRanges.splice(idx, 1) : activeCaratRanges.push({min, max});
            // Clear manual inputs
            document.getElementById('min-carat').value = '';
            document.getElementById('max-carat').value = '';
            runSearch();
        };

        // --- SEARCH ENGINE ---
        function getVal(id) { return parseFloat(document.getElementById(id).value); }

        window.runSearch = () => {
            // Get numeric inputs
            const minC = getVal('min-carat'), maxC = getVal('max-carat');
            const dMin = getVal('depth-min'), dMax = getVal('depth-max');
            const tMin = getVal('table-min'), tMax = getVal('table-max');
            const rMin = getVal('ratio-min'), rMax = getVal('ratio-max');
            // Measurements
            const m1Min = getVal('m1-min'), m1Max = getVal('m1-max');
            const m2Min = getVal('m2-min'), m2Max = getVal('m2-max');
            const m3Min = getVal('m3-min'), m3Max = getVal('m3-max');

            const results = inventoryData.filter(s => {
                // 1. Shape
                if (activeShapes.length && !activeShapes.includes(s.shape)) return false;

                // 2. Carat (Buttons OR Input)
                let cMatch = false;
                if (!isNaN(minC) || !isNaN(maxC)) {
                    cMatch = (isNaN(minC) || s.carat >= minC) && (isNaN(maxC) || s.carat <= maxC);
                } else if (activeCaratRanges.length) {
                    cMatch = activeCaratRanges.some(r => s.carat >= r.min && s.carat <= r.max);
                } else cMatch = true;
                if (!cMatch) return false;

                // 3. Color, Clarity, Cut, Pol, Sym
                if (activeColors.length && !activeColors.map(i=>colors[i]).includes(s.color)) return false;
                if (activeClarities.length && !activeClarities.map(i=>clarities[i]).includes(s.clarity)) return false;
                if (activeCuts.length && !activeCuts.map(i=>grades[i]).includes(s.cut)) return false;
                if (activePols.length && !activePols.map(i=>grades[i]).includes(s.pol)) return false;
                if (activeSyms.length && !activeSyms.map(i=>grades[i]).includes(s.sym)) return false;

                // 4. Advanced Numbers (Depth, Table, Ratio)
                if ((!isNaN(dMin) && s.depth < dMin) || (!isNaN(dMax) && s.depth > dMax)) return false;
                if ((!isNaN(tMin) && s.table < tMin) || (!isNaN(tMax) && s.table > tMax)) return false;
                if ((!isNaN(rMin) && s.ratio < rMin) || (!isNaN(rMax) && s.ratio > rMax)) return false;

                // 5. Measurements (1=L, 2=W, 3=D)
                if ((!isNaN(m1Min) && s.m1 < m1Min) || (!isNaN(m1Max) && s.m1 > m1Max)) return false;
                if ((!isNaN(m2Min) && s.m2 < m2Min) || (!isNaN(m2Max) && s.m2 > m2Max)) return false;
                if ((!isNaN(m3Min) && s.m3 < m3Min) || (!isNaN(m3Max) && s.m3 > m3Max)) return false;

                return true;
            });

            renderTable(results);
        };

        function renderTable(data) {
            const tbody = document.getElementById('table-body');
            document.getElementById('count').innerText = data.length;
            document.getElementById('mobile-count').innerText = `(${data.length})`;
            tbody.innerHTML = '';
            
            data.forEach(s => {
                const row = `<tr>
                    <td><b>${s.shape}</b></td>
                    <td>${s.carat}</td>
                    <td>${s.color}</td>
                    <td>${s.clarity}</td>
                    <td>${s.cut}</td>
                    <td>${s.pol}</td>
                    <td>${s.sym}</td>
                    <td>${s.fluor}</td>
                    <td>${s.depth}%</td>
                    <td>${s.table}%</td>
                    <td>${s.ratio}</td>
                    <td>${s.m1}x${s.m2}x${s.m3}</td>
                    <td>$${s.price.toLocaleString()}</td> 
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        window.toggleSidebar = () => document.getElementById('sidebar').classList.toggle('show');
        
        // Initial run
        runSearch();
    </script>
</body>
</html>
